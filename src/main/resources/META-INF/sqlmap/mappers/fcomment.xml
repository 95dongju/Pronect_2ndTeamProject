<!-- <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lec.cb.dao.CommentDao">
	<resultMap type="Fcomment" id="FcommentResult">
		<result property="fcid" column="fcid"/>
		<result property="mid" column="mid"/>
		<result property="fccontent" column="fccontent"/>
		<result property="fcip" column="fcip"/>
		<result property="fcrdate" column="fcrdate"/>
		<result property="fid" column="fid"/>
		<result property="fcgroup" column="fcgroup"/>
		<result property="fcstep" column="fcstep"/>
		<result property="fcindent" column="fcindent"/>
	</resultMap>
	
	<select id="fcommentList" parameterType="Fcomment" resultMap="FcommentResult">
		<![CDATA[
			SELECT * 
		    FROM (SELECT ROWNUM RN, A.* FROM (SELECT * FROM BCOMMENT WHERE BID=#{bid} ORDER BY CGROUP, CSTEP) A)
	    	WHERE RN BETWEEN #{startRow} AND #{endRow}
    	]]>
	</select>
	<select id="fcommentTotCnt" parameterType="int" resultType="int">
		SELECT COUNT(*) FROM BCOMMENT where bid= #{bid}
	</select>
	
	<insert id="fcommentWrite" parameterType="Comment">
		INSERT INTO BCOMMENT (CNUM, BID, CNAME, CMEMO, CGROUP, CSTEP, CINDENT, CIP)
    	VALUES (COMMENT_SQ.NEXTVAL, #{bid}, #{cname}, #{cmemo},COMMENT_SQ.CURRVAL, 0,0, #{cip})
	</insert>

	<update id="fcommentReplyPreStep" parameterType="Comment">
		UPDATE BCOMMENT SET SET CSTEP=CSTEP+1 WHERE CGROUP=#{cgroup} AND CSTEP>#{cstep}
	</update>
	
	<insert id="fcommentReply" parameterType="Comment">
		INSERT INTO BCOMMENT (CNUM, BID, CNAME, CMEMO, CGROUP, CSTEP, CINDENT, CIP)
		    VALUES (COMMENT_SQ.NEXTVAL, #{bid}, #{cname}, #{cmemo}, #{cgroup}, #{cstep}+1, #{cindent}+1, #{cip})
	</insert>
	<update id="fcommentModify" parameterType="Comment">
		UPDATE BCOMMENT SET
		    CNAME = #{cname},
		    CMEMO = #{cmemo},
		    CDATE = SYSDATE,
		    CIP = #{cip}
		  WHERE CNUM=#{cnum}
	</update>
	<delete id="fcommentDelete" parameterType="int">
		DELETE FROM BCOMMENT WHERE CNUM= #{cnum}
	</delete>
	<select id="fcommentContent" parameterType="int" resultType="Comment">
		SELECT * FROM BCOMMENT WHERE CNUM=#{cnum}
	</select>
</mapper> -->